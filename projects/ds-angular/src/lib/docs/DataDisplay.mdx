{/* DataDisplay.mdx */}
import { Meta } from '@storybook/blocks';

<Meta title="Components/Display" />

# Data Display

Composants pour afficher et présenter des données.

---

## Vue d'ensemble

La catégorie **Data Display** regroupe les composants dédiés à la présentation de données.

| Composant | Description |
|-----------|-------------|
| **DsAccordion** | Panneau expansible pour organiser le contenu |
| **DsTable** | Tableau de données avec tri et sélection |
| **DsAvatar** | Avatar utilisateur (image/initiales) |
| **DsBadge** | Badge pour indicateurs et compteurs |
| **DsChip** | Tag pour catégorisation et filtres |
| **DsRating** | Étoiles de notation |
| **DsProgressBar** | Barre de progression |
| **DsSkeleton** | Placeholder de chargement |
| **DsList** | Liste avec loading, empty, drag & drop, virtualisation |
| **DsListItem** | Élément de liste avec checkbox, indicateur, slots |
| **DsListGroup** | Groupe de listes avec en-tête |
| **DsCalendar** | Calendrier mensuel/annuel avec événements |
| **DsCarousel** | Carrousel d'images avec autoplay et swipe |
| **DsTimeline** | Timeline verticale d'événements |

---

## Patterns d'utilisation

### Tableau de données

```html
<ds-table
  [columns]="[
    { key: 'name', label: 'Nom', sortable: true },
    { key: 'email', label: 'Email' },
    { key: 'role', label: 'Rôle' }
  ]"
  [data]="users"
  [selectable]="true"
  variant="striped"
  (rowClick)="onRowClick($event)"
  (sortChange)="onSort($event)"
/>
```

### Avatar avec status

```html
<ds-avatar
  [src]="user.avatar"
  [name]="user.name"
  size="lg"
  status="online"
  shape="circle"
/>
```

### Badges et Chips

```html
<!-- Badge pour compteur -->
<ds-badge variant="primary" type="count">42</ds-badge>

<!-- Chip pour tags -->
<ds-chip
  variant="filled"
  color="primary"
  [removable]="true"
  (remove)="removeTag($event)"
>
  Angular
</ds-chip>
```

### Notation

```html
<ds-rating
  [(value)]="rating"
  [max]="5"
  [half]="true"
  size="md"
/>
```

### États de chargement

```html
<!-- Skeleton pour texte -->
<ds-skeleton variant="text" [lines]="3" />

<!-- Skeleton pour carte -->
<ds-skeleton variant="card" />

<!-- Progress bar -->
<ds-progress-bar
  [value]="progress"
  [max]="100"
  variant="success"
/>
```

---

## Variants visuels

### Tableaux

```html
<ds-table variant="default" />   <!-- Sans bordures -->
<ds-table variant="striped" />   <!-- Lignes alternées -->
<ds-table variant="bordered" />  <!-- Avec bordures -->
```

### Badges

```html
<ds-badge variant="primary" />
<ds-badge variant="success" />
<ds-badge variant="warning" />
<ds-badge variant="error" />
<ds-badge variant="info" />
```

### Progress

```html
<ds-progress-bar mode="determinate" [value]="75" />
<ds-progress-bar mode="indeterminate" />
```

---

## Accessibilité

### Tableaux

```html
<table role="grid" aria-label="Liste des utilisateurs">
  <thead>
    <tr>
      <th scope="col" aria-sort="ascending">Nom</th>
    </tr>
  </thead>
</table>
```

### Rating

```html
<div role="slider"
     aria-valuemin="0"
     aria-valuemax="5"
     aria-valuenow="3"
     aria-label="Note">
</div>
```

### Progress

```html
<div role="progressbar"
     aria-valuenow="75"
     aria-valuemin="0"
     aria-valuemax="100"
     aria-label="Progression du téléchargement">
</div>
```

---

## DsAccordion

Composant accordion pour afficher/masquer des sections de contenu expansibles avec animations fluides.

### Inputs

| Nom | Type | Défaut | Description |
|-----|------|--------|-------------|
| `items` | `AccordionItem[]` | **requis** | Liste des items de l'accordion |
| `multiple` | `boolean` | `false` | Permettre l'expansion de plusieurs items simultanément |
| `size` | `'sm' \| 'md' \| 'lg'` | `'md'` | Taille du composant |
| `variant` | `'default' \| 'bordered' \| 'separated'` | `'default'` | Variant de style |
| `expandedIds` | `string[]` | `[]` | IDs des items initialement ouverts |
| `disabled` | `boolean` | `false` | Désactiver tout l'accordion |

### Outputs

| Nom | Type | Description |
|-----|------|-------------|
| `itemChange` | `AccordionChangeEvent` | Événement émis lors du changement d'état d'un item |

### Types

```typescript
interface AccordionItem {
  id: string;
  header: string;
  content: string;
  disabled?: boolean;
}

interface AccordionChangeEvent {
  itemId: string;
  expanded: boolean;
  expandedItems: string[];
}
```

### Exemples

```html
<!-- Usage basique -->
<ds-accordion
  [items]="items"
  [multiple]="false"
  size="md"
  variant="bordered"
  (itemChange)="onItemChange($event)"
/>
```

```typescript
items: AccordionItem[] = [
  { id: '1', header: 'Section 1', content: 'Contenu de la section 1' },
  { id: '2', header: 'Section 2', content: 'Contenu de la section 2' },
  { id: '3', header: 'Section désactivée', content: '...', disabled: true },
];

onItemChange(event: AccordionChangeEvent) {
  console.log(`Item ${event.itemId} is now ${event.expanded ? 'open' : 'closed'}`);
}
```

### Variants

```html
<ds-accordion [items]="items" variant="default" />   <!-- Sans bordures -->
<ds-accordion [items]="items" variant="bordered" />  <!-- Avec bordures -->
<ds-accordion [items]="items" variant="separated" /> <!-- Items séparés -->
```

### Multi-expansion

```html
<!-- Un seul panneau ouvert à la fois (défaut) -->
<ds-accordion [items]="items" [multiple]="false" />

<!-- Plusieurs panneaux ouverts simultanément -->
<ds-accordion [items]="items" [multiple]="true" />
```

### Contrôle programmatique

```typescript
@ViewChild(DsAccordion) accordion!: DsAccordion;

expandAll() {
  this.accordion.expandAll();
}

collapseAll() {
  this.accordion.collapseAll();
}
```

### Accessibilité

| Touche | Action |
|--------|--------|
| `Enter` / `Space` | Ouvre/ferme le panneau |
| `↑` `↓` | Navigue entre les headers |
| `Home` | Premier header |
| `End` | Dernier header |

```html
<!-- Structure ARIA générée -->
<button aria-expanded="true" aria-controls="accordion-content-1">
  Section 1
</button>
<div id="accordion-content-1" role="region" aria-labelledby="accordion-header-1">
  Contenu
</div>
```

### Stories disponibles

Default, Multiple, Bordered, Separated, SmallSize, LargeSize, WithInitialExpanded, MultipleExpanded, Disabled, WithDisabledItem, FAQ, LongContent, Themed, Accessibility, WithInteractionTest

---

## DsList

Composant conteneur pour afficher une liste d'éléments avec support pour état de chargement, état vide, Drag & Drop, virtualisation et sélection multiple.

### Inputs

| Nom | Type | Défaut | Description |
|-----|------|--------|-------------|
| `variant` | `'default' \| 'divided' \| 'card'` | `'default'` | Variante visuelle |
| `size` | `'sm' \| 'md' \| 'lg'` | `'md'` | Taille de la liste |
| `loading` | `boolean` | `false` | Affiche les skeletons |
| `loadingCount` | `number` | `3` | Nombre de skeletons |
| `empty` | `boolean` | `false` | Affiche l'état vide |
| `emptyTitle` | `string` | `'Aucun élément'` | Titre état vide |
| `emptyDescription` | `string` | `-` | Description état vide |
| `draggable` | `boolean` | `false` | Active Drag & Drop |
| `dragDisabled` | `boolean` | `false` | Désactive le drag |
| `dragData` | `T[]` | `[]` | Données pour le drag |
| `virtual` | `boolean` | `false` | Active la virtualisation |
| `itemSize` | `number` | `40` | Hauteur item (px) |
| `viewportHeight` | `number` | `400` | Hauteur viewport (px) |
| `selectable` | `boolean` | `false` | Active la sélection |
| `selectedItems` | `T[]` | `[]` | Items sélectionnés |

### Outputs

| Nom | Type | Description |
|-----|------|-------------|
| `dropped` | `ListDragEvent<T>` | Événement de drop |
| `selectionChange` | `ListSelectionChangeEvent<T>` | Changement de sélection |

### Exemples

```html
<!-- Liste basique -->
<ds-list>
  <ds-list-item title="Item 1" />
  <ds-list-item title="Item 2" />
</ds-list>

<!-- Avec loading et empty -->
<ds-list
  [loading]="isLoading()"
  [empty]="items().length === 0"
  emptyTitle="Aucun élément"
>
  @for (item of items(); track item.id) {
    <ds-list-item [title]="item.title" />
  }
</ds-list>

<!-- Avec Drag & Drop -->
<ds-list variant="card" [draggable]="true" [dragData]="items()" (dropped)="onDrop($event)">
  @for (item of items(); track item.id) {
    <ds-list-item [title]="item.title" [checkable]="true" cdkDrag />
  }
</ds-list>
```

---

## DsListItem

Composant de ligne d'élément de liste interactif, style TickTick/Todoist. Supporte checkbox intégrée, indicateur de priorité, et slots pour métadonnées.

### Inputs

| Nom | Type | Défaut | Description |
|-----|------|--------|-------------|
| `title` | `string` | **requis** | Titre principal de l'élément |
| `subtitle` | `string` | `-` | Sous-titre optionnel |
| `indicator` | `'none' \| 'priority' \| 'dot' \| 'status'` | `'none'` | Type d'indicateur visuel |
| `indicatorColor` | `'high' \| 'medium' \| 'low' \| 'success' \| 'warning' \| 'error' \| 'info' \| string` | `'medium'` | Couleur de l'indicateur |
| `checkable` | `boolean` | `false` | Affiche une checkbox |
| `checked` | `boolean` | `false` | État coché |
| `indeterminate` | `boolean` | `false` | État indéterminé |
| `completed` | `boolean` | `false` | Style complété (texte barré) |
| `disabled` | `boolean` | `false` | Désactive l'interaction |
| `selected` | `boolean` | `false` | Style de sélection |
| `clickable` | `boolean` | `true` | Rend l'élément cliquable |
| `size` | `'sm' \| 'md' \| 'lg'` | `'md'` | Taille de l'élément |

### Outputs

| Nom | Type | Description |
|-----|------|-------------|
| `checkedChange` | `ListItemCheckEvent` | Émis lors du changement de la checkbox |
| `clicked` | `ListItemClickEvent` | Émis lors du clic |

### Slots

| Nom | Description |
|-----|-------------|
| `[inline]` | Contenu inline (tags, badges) |
| `[meta]` | Métadonnées (time, duration) |
| `[actions]` | Actions (boutons, menus) - visibles au hover |

### Exemples

```html
<!-- Basique -->
<ds-list-item title="Ma tâche" />

<!-- Avec checkbox et priorité -->
<ds-list-item
  title="Tâche importante"
  [checkable]="true"
  [checked]="task.completed"
  indicator="priority"
  indicatorColor="high"
  (checkedChange)="onComplete($event)"
/>

<!-- Avec métadonnées -->
<ds-list-item title="Réunion" [checkable]="true">
  <ds-chip inline size="sm">Travail</ds-chip>
  <span meta>09:00</span>
  <span meta>30min</span>
</ds-list-item>
```

---

## DsListGroup

Composant de regroupement d'éléments de liste avec header et contenu collapsible. Idéal pour organiser les tâches par date, catégorie ou statut.

### Inputs

| Nom | Type | Défaut | Description |
|-----|------|--------|-------------|
| `title` | `string` | **requis** | Titre du groupe |
| `subtitle` | `string` | `-` | Sous-titre optionnel |
| `count` | `number` | `-` | Nombre d'éléments (badge) |
| `variant` | `'default' \| 'collapsible'` | `'default'` | Variante du groupe |
| `expanded` | `boolean` | `true` | État expanded (collapsible) |
| `sticky` | `boolean` | `false` | Header sticky au scroll |
| `icon` | `IconDefinition` | `-` | Icône personnalisée |

### Outputs

| Nom | Type | Description |
|-----|------|-------------|
| `expandedChange` | `ListGroupToggleEvent` | Émis lors du toggle |

### Exemples

```html
<!-- Groupe simple -->
<ds-list-group title="Aujourd'hui">
  <ds-list-item title="Tâche 1" />
  <ds-list-item title="Tâche 2" />
</ds-list-group>

<!-- Groupe collapsible avec compteur -->
<ds-list-group
  title="Cette semaine"
  [count]="5"
  variant="collapsible"
  [expanded]="true"
>
  <ds-list-item title="Tâche 1" />
</ds-list-group>

<!-- Groupes dans une liste -->
<ds-list>
  <ds-list-group title="Haute priorité" [count]="3" variant="collapsible">
    <ds-list-item title="Urgent" indicator="priority" indicatorColor="high" />
  </ds-list-group>
  <ds-list-group title="Normale" [count]="5" variant="collapsible">
    <ds-list-item title="Standard" />
  </ds-list-group>
</ds-list>
```

---

## DsCalendar

Composant calendrier mensuel/annuel avec gestion d'événements, navigation et personnalisation de la locale.

### Inputs

| Nom | Type | Défaut | Description |
|-----|------|--------|-------------|
| `value` | `Date` | `new Date()` | Date courante affichée |
| `mode` | `'month' \| 'year'` | `'month'` | Mode d'affichage |
| `events` | `CalendarEvent[]` | `[]` | Événements à afficher |
| `size` | `'sm' \| 'md' \| 'lg'` | `'md'` | Taille du calendrier |
| `locale` | `string` | `'fr-FR'` | Locale pour les noms de jours/mois |
| `firstDayOfWeek` | `number` | `1` | Premier jour (0=dimanche, 1=lundi) |
| `disabledDate` | `(date: Date) => boolean` | `undefined` | Fonction pour désactiver des dates |

### Outputs

| Nom | Type | Description |
|-----|------|-------------|
| `dateSelect` | `Date` | Émis lors de la sélection d'une date |
| `monthChange` | `Date` | Émis lors du changement de mois |
| `modeChange` | `CalendarMode` | Émis lors du changement de mode |
| `eventClick` | `CalendarEvent` | Émis lors du clic sur un événement |

### Types

```typescript
interface CalendarEvent {
  id: string;
  date: Date;
  title: string;
  type?: 'default' | 'success' | 'warning' | 'error';
}

type CalendarMode = 'month' | 'year';
type CalendarSize = 'sm' | 'md' | 'lg';
```

### Exemples

```html
<!-- Calendrier basique -->
<ds-calendar
  [value]="currentDate"
  (dateSelect)="onDateSelect($event)"
/>

<!-- Avec événements -->
<ds-calendar
  [value]="currentDate"
  [events]="calendarEvents"
  (eventClick)="onEventClick($event)"
/>

<!-- Avec dates désactivées -->
<ds-calendar
  [value]="currentDate"
  [disabledDate]="isWeekend"
/>
```

```typescript
calendarEvents: CalendarEvent[] = [
  { id: '1', date: new Date(), title: 'Réunion', type: 'primary' },
  { id: '2', date: new Date(), title: 'Deadline', type: 'error' },
];

isWeekend(date: Date): boolean {
  return date.getDay() === 0 || date.getDay() === 6;
}
```

### Accessibilité

| Touche | Action |
|--------|--------|
| `←` `→` | Jour précédent/suivant |
| `↑` `↓` | Semaine précédente/suivante |
| `Enter` | Sélectionne la date |

### Stories disponibles

Default, WithEvents, YearMode, SmallSize, LargeSize, WithDisabledDates, French, English, AllSizes, Accessibility

---

## DsCarousel

Carrousel d'images/slides avec autoplay, navigation clavier, touch swipe et effets de transition.

### Inputs

| Nom | Type | Défaut | Description |
|-----|------|--------|-------------|
| `slides` | `CarouselSlide[]` | `[]` | Liste des slides |
| `autoplay` | `boolean` | `false` | Active l'autoplay |
| `autoplaySpeed` | `number` | `3000` | Vitesse d'autoplay en ms |
| `effect` | `'slide' \| 'fade'` | `'slide'` | Effet de transition |
| `dots` | `boolean` | `true` | Affiche les indicateurs |
| `dotsPosition` | `'bottom' \| 'top' \| 'left' \| 'right'` | `'bottom'` | Position des dots |
| `arrows` | `boolean` | `true` | Affiche les flèches de navigation |
| `infinite` | `boolean` | `true` | Boucle infinie |
| `pauseOnHover` | `boolean` | `true` | Pause au survol |
| `activeIndex` | `number` | `0` | Index du slide actif |

### Outputs

| Nom | Type | Description |
|-----|------|-------------|
| `slideChange` | `{ index: number; slide: CarouselSlide }` | Émis au changement de slide |

### Types

```typescript
interface CarouselSlide {
  id: string;
  image?: string;
  alt?: string;
  title?: string;
  description?: string;
}

type CarouselEffect = 'slide' | 'fade';
type CarouselDotsPosition = 'bottom' | 'top' | 'left' | 'right';
```

### Exemples

```html
<!-- Carousel basique -->
<ds-carousel
  [slides]="slides"
  (slideChange)="onSlideChange($event)"
/>

<!-- Avec autoplay -->
<ds-carousel
  [slides]="slides"
  [autoplay]="true"
  [autoplaySpeed]="5000"
  [pauseOnHover]="true"
/>

<!-- Effet fade sans boucle -->
<ds-carousel
  [slides]="slides"
  effect="fade"
  [infinite]="false"
/>
```

```typescript
slides: CarouselSlide[] = [
  { id: '1', image: '/img/slide1.jpg', title: 'Titre 1', description: 'Description' },
  { id: '2', image: '/img/slide2.jpg', title: 'Titre 2' },
  { id: '3', image: '/img/slide3.jpg', alt: 'Image 3' },
];
```

### Accessibilité

| Touche | Action |
|--------|--------|
| `←` | Slide précédent |
| `→` | Slide suivant |
| `Home` | Premier slide |
| `End` | Dernier slide |

### Touch gestures

- **Swipe gauche** : Slide suivant
- **Swipe droite** : Slide précédent

### Stories disponibles

Default, WithAutoplay, FadeEffect, WithoutDots, WithoutArrows, NotInfinite, DotsTop, DotsLeft, AllEffects, Accessibility

---

## DsTimeline

Composant pour afficher une liste d'événements dans un ordre chronologique vertical.

### Inputs

| Nom | Type | Défaut | Description |
|-----|------|--------|-------------|
| `items` | `TimelineItem[]` | **requis** | Liste des événements |
| `mode` | `'left' \| 'right' \| 'alternate'` | `'left'` | Mode d'affichage |
| `size` | `'sm' \| 'md' \| 'lg'` | `'md'` | Taille du composant |
| `pending` | `boolean` | `false` | Affiche un indicateur "en cours" |
| `pendingContent` | `string` | `'En cours...'` | Texte de l'indicateur pending |
| `reverse` | `boolean` | `false` | Inverse l'ordre (plus récent en haut) |

### Outputs

| Nom | Type | Description |
|-----|------|-------------|
| `itemClick` | `TimelineItemClickEvent` | Émis au clic sur un item |

### Types

```typescript
interface TimelineItem {
  content: string;
  date?: string;
  icon?: IconDefinition;
  color?: 'default' | 'primary' | 'success' | 'warning' | 'error' | 'info';
  position?: 'left' | 'right';
}

interface TimelineItemClickEvent {
  item: TimelineItem;
  index: number;
}

type TimelineMode = 'left' | 'right' | 'alternate';
type TimelineSize = 'sm' | 'md' | 'lg';
```

### Exemples

```html
<!-- Timeline basique -->
<ds-timeline
  [items]="events"
  mode="left"
/>

<!-- Mode alterné avec pending -->
<ds-timeline
  [items]="events"
  mode="alternate"
  [pending]="true"
  pendingContent="Prochain événement..."
/>

<!-- Ordre inversé -->
<ds-timeline
  [items]="events"
  [reverse]="true"
/>
```

```typescript
events: TimelineItem[] = [
  { content: 'Commande passée', date: '2024-01-15', color: 'success' },
  { content: 'En préparation', date: '2024-01-16', color: 'primary' },
  { content: 'Expédié', date: '2024-01-17', color: 'info' },
];
```

### Modes d'affichage

| Mode | Description |
|------|-------------|
| `left` | Contenu aligné à droite de la ligne |
| `right` | Contenu aligné à gauche de la ligne |
| `alternate` | Contenu alterné gauche/droite |

### Accessibilité

- Liste sémantique avec `role="list"` et `role="listitem"`
- Navigation clavier avec Enter/Space pour interagir
- Dates et contenus avec attributs ARIA

### Stories disponibles

Default, ModeLeft, ModeRight, ModeAlternate, WithPending, Reversed, WithIcons, WithColors, AllSizes, Accessibility
