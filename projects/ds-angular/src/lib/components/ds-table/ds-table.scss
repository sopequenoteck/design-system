.ds-table {
  font-family: var(--font-family-base);
  color: var(--text-default);

  &__wrapper {
    overflow-x: auto;
    border: 1px solid var(--table-border-color, var(--border-color));
    border-radius: var(--table-radius, var(--radius-2));
  }

  &__element {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
  }

  // Header
  &__header {
    background-color: var(--table-header-bg, var(--surface-secondary));
  }

  &__row {
    &--header {
      border-bottom: 1px solid var(--table-border-color, var(--border-color));
    }

    &--body {
      border-bottom: 1px solid var(--table-row-border, color-mix(in oklab, var(--border-color) 50%, transparent));

      &:last-child {
        border-bottom: none;
      }
    }

    &--selected {
      background-color: var(--table-row-selected-bg, color-mix(in oklab, var(--color-primary) 10%, transparent));
    }

    &--loading,
    &--empty {
      background-color: transparent;
    }
  }

  // Cells
  &__cell {
    padding: var(--table-cell-padding-md, var(--space-3));
    text-align: left;
    vertical-align: middle;

    &--header {
      font-weight: var(--font-weight-semibold);
      color: var(--table-header-text, var(--text-default));
      white-space: nowrap;
    }

    &--sortable {
      cursor: pointer;
      user-select: none;
      transition:
        background-color var(--duration-fast) var(--easing-default),
        color var(--duration-fast) var(--easing-default);

      &:hover {
        background-color: var(--table-header-hover-bg, var(--surface-hover));
      }

      &:focus-visible {
        outline: none;
        box-shadow: inset 0 0 0 2px var(--color-primary);
      }
    }

    &--sorted {
      color: var(--color-primary);
    }

    &--checkbox {
      width: 48px;
      text-align: center;
    }

    &--loading,
    &--empty {
      padding: var(--space-6);
      text-align: center;
      color: var(--text-muted);
    }
  }

  &__header-content {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }

  &__header-label {
    flex: 1;
  }

  &__sort-icon {
    display: flex;
    align-items: center;
    color: var(--text-muted);
    transition:
      color var(--duration-fast) var(--easing-default),
      transform var(--duration-fast) var(--easing-default);

    &--active {
      color: var(--color-primary);
    }
  }

  // Checkbox
  &__checkbox {
    width: 16px;
    height: 16px;
    cursor: pointer;
    accent-color: var(--color-primary);
  }

  // Loading
  &__loading {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
  }

  &__loading-spinner {
    width: 20px;
    height: 20px;
    border: 2px solid var(--border-color);
    border-top-color: var(--color-primary);
    border-radius: 50%;
    animation: ds-table-spin 0.8s linear infinite;
  }

  &__loading-text {
    font-style: italic;
  }

  // Empty state
  &__empty {
    font-style: italic;
  }

  // Sizes
  &--sm {
    .ds-table__cell {
      padding: var(--table-cell-padding-sm, var(--space-2));
      font-size: var(--font-size-2);
    }

    .ds-table__checkbox {
      width: 14px;
      height: 14px;
    }
  }

  &--lg {
    .ds-table__cell {
      padding: var(--table-cell-padding-lg, var(--space-4));
      font-size: var(--font-size-4);
    }

    .ds-table__checkbox {
      width: 18px;
      height: 18px;
    }
  }

  // Variants
  &--striped {
    .ds-table__row--body:nth-child(even) {
      background-color: var(--table-stripe-bg, var(--surface-secondary));
    }

    .ds-table__row--body.ds-table__row--selected {
      background-color: var(--table-row-selected-bg, color-mix(in oklab, var(--color-primary) 10%, transparent));
    }
  }

  &--bordered {
    .ds-table__cell {
      border: 1px solid var(--table-border-color, var(--border-color));
    }
  }

  // Hoverable
  &--hoverable {
    .ds-table__row--body:not(.ds-table__row--loading):not(.ds-table__row--empty) {
      transition: background-color var(--duration-fast) var(--easing-default);

      &:hover {
        background-color: var(--table-row-hover-bg, var(--surface-hover));
      }
    }
  }

  // Sticky header
  &--sticky-header {
    .ds-table__header {
      position: sticky;
      top: 0;
      z-index: 1;
    }
  }

  // Loading overlay
  &--loading {
    opacity: 0.7;
    pointer-events: none;
  }

  // Selectable cursor
  &--selectable {
    .ds-table__row--body {
      cursor: pointer;
    }
  }
}

@keyframes ds-table-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
