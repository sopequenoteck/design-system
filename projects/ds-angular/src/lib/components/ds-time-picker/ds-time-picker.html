<div [class]="containerClasses()">
  <div class="ds-time-picker__wrapper">
    <div
      #inputElement
      #triggerOrigin="cdkOverlayOrigin"
      cdkOverlayOrigin
      class="ds-time-picker__input"
      [class.ds-time-picker__input--disabled]="disabled()"
      [class.ds-time-picker__input--readonly]="readonly()"
      [class.ds-time-picker__input--focused]="isFocused()"
      [attr.tabindex]="isDisabled() ? -1 : 0"
      [attr.role]="'combobox'"
      [attr.aria-expanded]="isOpen()"
      [attr.aria-haspopup]="'dialog'"
      [attr.aria-controls]="isOpen() ? panelId : null"
      [attr.aria-label]="placeholder()"
      (click)="toggle()"
      (focus)="onFocus()"
      (blur)="onBlur()"
      (keydown.enter)="toggle()"
      (keydown.space)="toggle(); $event.preventDefault()"
      (keydown.escape)="close()">

      <fa-icon
        class="ds-time-picker__icon"
        [icon]="clockIcon"
        aria-hidden="true">
      </fa-icon>

      <span class="ds-time-picker__display">
        @if (displayValue(); as display) {
          {{ display }}
        } @else {
          <span class="ds-time-picker__placeholder">{{ placeholder() }}</span>
        }
      </span>
    </div>
  </div>
</div>

<!-- Panel Overlay -->
<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOrigin]="triggerOrigin"
  [cdkConnectedOverlayOpen]="isOpen()"
  [cdkConnectedOverlayPositions]="overlayPositions"
  [cdkConnectedOverlayHasBackdrop]="true"
  [cdkConnectedOverlayBackdropClass]="'cdk-overlay-transparent-backdrop'"
  [cdkConnectedOverlayPanelClass]="'ds-time-picker-panel-overlay'"
  (backdropClick)="onBackdropClick()"
  (overlayKeydown)="onOverlayKeydown($event)">

  <ds-time-picker-panel
    [panelId]="panelId"
    [value]="internalValue()"
    [format]="format()"
    [showSeconds]="showSeconds()"
    [minuteStep]="minuteStep()"
    [hourStep]="hourStep()"
    [minTime]="minTime()"
    [maxTime]="maxTime()"
    (timeSelected)="onTimeSelected($event)">
  </ds-time-picker-panel>
</ng-template>
