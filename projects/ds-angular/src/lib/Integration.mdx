{/* Integration.mdx */}
import { Meta } from '@storybook/blocks';

<Meta title="Guides/Integration" />

# Intégration avec Angular

Ce guide documente l'intégration des composants ds-angular avec les fonctionnalités Angular modernes : reactive forms, signals, validation et gestion d'erreurs.

---

## 1. Reactive Forms (FormControl, FormGroup)

Les composants ds-angular implémentent `ControlValueAccessor` et s'intègrent parfaitement avec les reactive forms.

### Exemple complet avec validation

```typescript
// src/app/contact/contact.component.ts
import { Component, signal } from '@angular/core';
import { ReactiveFormsModule, FormBuilder, FormGroup, Validators } from '@angular/forms';
import { DsInputField, DsInputTextarea, DsCheckbox, DsButton } from 'ds-angular';
import { faUser, faEnvelope } from '@fortawesome/free-solid-svg-icons';

@Component({
  selector: 'app-contact',
  standalone: true,
  imports: [ReactiveFormsModule, DsInputField, DsInputTextarea, DsCheckbox, DsButton],
  template: `
    <form [formGroup]="contactForm" (ngSubmit)="onSubmit()" class="contact-form">
      <h2>Formulaire de contact</h2>

      <!-- Nom -->
      <ds-input-field
        formControlName="name"
        name="name"
        label="Nom complet"
        placeholder="Jean Dupont"
        [iconStart]="userIcon"
        [error]="getFieldError('name')"
        required>
      </ds-input-field>

      <!-- Email -->
      <ds-input-field
        formControlName="email"
        name="email"
        type="email"
        label="Adresse email"
        placeholder="jean.dupont@exemple.com"
        [iconStart]="emailIcon"
        [error]="getFieldError('email')"
        required>
      </ds-input-field>

      <!-- Sujet -->
      <ds-input-field
        formControlName="subject"
        name="subject"
        label="Sujet"
        placeholder="Comment pouvons-nous vous aider ?"
        [error]="getFieldError('subject')"
        required>
      </ds-input-field>

      <!-- Message -->
      <ds-input-textarea
        formControlName="message"
        name="message"
        label="Message"
        placeholder="Décrivez votre demande..."
        [rows]="6"
        [maxlength]="500"
        [error]="getFieldError('message')"
        required>
      </ds-input-textarea>

      <!-- Newsletter -->
      <ds-checkbox
        formControlName="newsletter"
        name="newsletter"
        label="Recevoir notre newsletter hebdomadaire">
      </ds-checkbox>

      <!-- État du formulaire (debug) -->
      <div class="form-status">
        <p>Valid: {{ contactForm.valid }}</p>
        <p>Dirty: {{ contactForm.dirty }}</p>
        <p>Touched: {{ contactForm.touched }}</p>
      </div>

      <!-- Actions -->
      <div class="form-actions">
        <ds-button
          variant="ghost"
          (clicked)="resetForm()">
          Réinitialiser
        </ds-button>
        <ds-button
          variant="primary"
          submit
          [disabled]="!contactForm.valid"
          [loading]="isSubmitting()">
          Envoyer
        </ds-button>
      </div>
    </form>
  `,
  styles: [`
    .contact-form {
      max-width: 600px;
      margin: 0 auto;
      padding: var(--space-6);
      display: flex;
      flex-direction: column;
      gap: var(--space-4);
    }
    .form-status {
      padding: var(--space-3);
      background: var(--background-secondary);
      border-radius: var(--radius-2);
      font-size: 0.875rem;
    }
    .form-actions {
      display: flex;
      gap: var(--space-3);
      justify-content: flex-end;
    }
  `]
})
export class ContactComponent {
  private fb = inject(FormBuilder);

  userIcon = faUser;
  emailIcon = faEnvelope;

  isSubmitting = signal(false);

  contactForm: FormGroup = this.fb.group({
    name: ['', [Validators.required, Validators.minLength(3)]],
    email: ['', [Validators.required, Validators.email]],
    subject: ['', [Validators.required, Validators.minLength(5)]],
    message: ['', [Validators.required, Validators.minLength(10), Validators.maxLength(500)]],
    newsletter: [false]
  });

  /**
   * Récupère le message d'erreur d'un champ
   */
  getFieldError(fieldName: string): string {
    const field = this.contactForm.get(fieldName);

    if (!field || !field.errors || !field.touched) {
      return '';
    }

    if (field.errors['required']) {
      return 'Ce champ est requis';
    }
    if (field.errors['email']) {
      return 'Email invalide';
    }
    if (field.errors['minlength']) {
      const min = field.errors['minlength'].requiredLength;
      return `Minimum ${min} caractères`;
    }
    if (field.errors['maxlength']) {
      const max = field.errors['maxlength'].requiredLength;
      return `Maximum ${max} caractères`;
    }

    return 'Erreur de validation';
  }

  /**
   * Soumission du formulaire
   */
  onSubmit() {
    if (!this.contactForm.valid) {
      // Marquer tous les champs comme touched pour afficher les erreurs
      Object.keys(this.contactForm.controls).forEach(key => {
        this.contactForm.get(key)?.markAsTouched();
      });
      return;
    }

    this.isSubmitting.set(true);

    // Simulation d'appel API
    setTimeout(() => {
      console.log('Formulaire soumis:', this.contactForm.value);
      this.isSubmitting.set(false);
      this.contactForm.reset();
    }, 2000);
  }

  /**
   * Réinitialiser le formulaire
   */
  resetForm() {
    this.contactForm.reset();
  }
}
```

### Validators personnalisés

```typescript
import { AbstractControl, ValidationErrors, ValidatorFn } from '@angular/forms';

/**
 * Validator pour vérifier que le mot de passe contient au moins une majuscule
 */
export function passwordStrengthValidator(): ValidatorFn {
  return (control: AbstractControl): ValidationErrors | null => {
    const value = control.value;
    if (!value) return null;

    const hasUpperCase = /[A-Z]/.test(value);
    const hasNumber = /[0-9]/.test(value);
    const hasSpecialChar = /[!@#$%^&*]/.test(value);

    const errors: any = {};

    if (!hasUpperCase) errors['noUpperCase'] = true;
    if (!hasNumber) errors['noNumber'] = true;
    if (!hasSpecialChar) errors['noSpecialChar'] = true;

    return Object.keys(errors).length > 0 ? errors : null;
  };
}

/**
 * Validator pour vérifier que deux champs sont identiques
 */
export function matchFieldsValidator(field1: string, field2: string): ValidatorFn {
  return (formGroup: AbstractControl): ValidationErrors | null => {
    const control1 = formGroup.get(field1);
    const control2 = formGroup.get(field2);

    if (!control1 || !control2) return null;

    return control1.value === control2.value ? null : { fieldsDoNotMatch: true };
  };
}
```

---

## 2. Signals (input(), computed())

Les composants ds-angular utilisent les signals Angular pour une meilleure réactivité et performance.

### Exemple avec computed signals et effects

```typescript
// src/app/cart/cart.component.ts
import { Component, signal, computed, effect } from '@angular/core';
import { DsButton, DsBadge, DsInputField, DsToastService } from 'ds-angular';
import { faShoppingCart, faTrash, faPlus, faMinus } from '@fortawesome/free-solid-svg-icons';

interface CartItem {
  id: number;
  name: string;
  price: number;
  quantity: number;
}

@Component({
  selector: 'app-cart',
  standalone: true,
  imports: [DsButton, DsBadge, DsInputField],
  template: `
    <div class="cart">
      <div class="cart-header">
        <h2>Panier</h2>
        <ds-badge [variant]="cartBadgeVariant()" size="md">
          {{ totalItems() }} article{{ totalItems() > 1 ? 's' : '' }}
        </ds-badge>
      </div>

      @if (items().length === 0) {
        <p class="empty-cart">Votre panier est vide</p>
      } @else {
        <div class="cart-items">
          @for (item of items(); track item.id) {
            <div class="cart-item">
              <div class="item-info">
                <h4>{{ item.name }}</h4>
                <p>{{ item.price }}€</p>
              </div>

              <div class="item-quantity">
                <ds-button
                  variant="ghost"
                  size="sm"
                  [iconStart]="minusIcon"
                  (clicked)="decrementQuantity(item.id)">
                </ds-button>
                <span>{{ item.quantity }}</span>
                <ds-button
                  variant="ghost"
                  size="sm"
                  [iconStart]="plusIcon"
                  (clicked)="incrementQuantity(item.id)">
                </ds-button>
              </div>

              <ds-button
                variant="error"
                size="sm"
                [iconStart]="trashIcon"
                (clicked)="removeItem(item.id)">
              </ds-button>
            </div>
          }
        </div>

        <div class="cart-footer">
          <div class="totals">
            <p>Sous-total: <strong>{{ subtotal() }}€</strong></p>
            <p>TVA (20%): <strong>{{ vat() }}€</strong></p>
            <p class="total">Total: <strong>{{ total() }}€</strong></p>
          </div>

          <div class="actions">
            <ds-button
              variant="ghost"
              (clicked)="clearCart()">
              Vider le panier
            </ds-button>
            <ds-button
              variant="primary"
              [disabled]="items().length === 0"
              (clicked)="checkout()">
              Commander ({{ total() }}€)
            </ds-button>
          </div>
        </div>
      }
    </div>
  `,
  styles: [`
    .cart {
      max-width: 600px;
      margin: 0 auto;
      padding: var(--space-6);
    }
    .cart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-4);
    }
    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-4);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-2);
      margin-bottom: var(--space-3);
    }
    .item-quantity {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    .cart-footer {
      margin-top: var(--space-6);
      padding-top: var(--space-4);
      border-top: 2px solid var(--border-default);
    }
    .totals p { margin: var(--space-2) 0; }
    .total { font-size: 1.25rem; margin-top: var(--space-3); }
    .actions {
      display: flex;
      gap: var(--space-3);
      margin-top: var(--space-4);
    }
  `]
})
export class CartComponent {
  private toastService = inject(DsToastService);

  plusIcon = faPlus;
  minusIcon = faMinus;
  trashIcon = faTrash;

  // State avec signals
  items = signal<CartItem[]>([
    { id: 1, name: 'Produit A', price: 29.99, quantity: 2 },
    { id: 2, name: 'Produit B', price: 49.99, quantity: 1 }
  ]);

  // Computed signals
  totalItems = computed(() => {
    return this.items().reduce((sum, item) => sum + item.quantity, 0);
  });

  subtotal = computed(() => {
    return this.items()
      .reduce((sum, item) => sum + (item.price * item.quantity), 0)
      .toFixed(2);
  });

  vat = computed(() => {
    return (parseFloat(this.subtotal()) * 0.2).toFixed(2);
  });

  total = computed(() => {
    return (parseFloat(this.subtotal()) + parseFloat(this.vat())).toFixed(2);
  });

  cartBadgeVariant = computed(() => {
    const count = this.totalItems();
    if (count === 0) return 'neutral';
    if (count > 5) return 'warning';
    return 'info';
  });

  // Effect pour logger les changements
  logEffect = effect(() => {
    console.log('Cart updated:', {
      items: this.items().length,
      total: this.total()
    });
  });

  incrementQuantity(id: number) {
    this.items.update(items =>
      items.map(item =>
        item.id === id
          ? { ...item, quantity: item.quantity + 1 }
          : item
      )
    );
  }

  decrementQuantity(id: number) {
    this.items.update(items =>
      items.map(item =>
        item.id === id && item.quantity > 1
          ? { ...item, quantity: item.quantity - 1 }
          : item
      )
    );
  }

  removeItem(id: number) {
    const item = this.items().find(i => i.id === id);
    this.items.update(items => items.filter(item => item.id !== id));
    this.toastService.success('Retiré du panier', `${item?.name} a été retiré`);
  }

  clearCart() {
    this.items.set([]);
    this.toastService.info('Panier vidé', 'Tous les articles ont été retirés');
  }

  checkout() {
    this.toastService.success('Commande validée', `Total: ${this.total()}€`);
    this.items.set([]);
  }
}
```

---

## 3. Validation et gestion d'erreurs

Stratégies avancées pour la validation et l'affichage des erreurs.

### Validation asynchrone (API)

```typescript
// src/app/validators/async-validators.ts
import { Injectable } from '@angular/core';
import { AbstractControl, AsyncValidator, ValidationErrors } from '@angular/forms';
import { Observable, of, delay, map } from 'rxjs';

@Injectable({ providedIn: 'root' })
export class UsernameValidator implements AsyncValidator {
  validate(control: AbstractControl): Observable<ValidationErrors | null> {
    if (!control.value) {
      return of(null);
    }

    // Simulation d'appel API pour vérifier la disponibilité
    return of(control.value).pipe(
      delay(1000), // Simule latence réseau
      map(username => {
        const existingUsernames = ['admin', 'user', 'test'];
        return existingUsernames.includes(username.toLowerCase())
          ? { usernameTaken: true }
          : null;
      })
    );
  }
}
```

### Composant avec validation asynchrone

```typescript
// src/app/register/register.component.ts
import { Component, inject } from '@angular/core';
import { ReactiveFormsModule, FormBuilder, Validators } from '@angular/forms';
import { DsInputField, DsButton } from 'ds-angular';
import { UsernameValidator } from '../validators/async-validators';

@Component({
  selector: 'app-register',
  standalone: true,
  imports: [ReactiveFormsModule, DsInputField, DsButton],
  template: `
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <ds-input-field
        formControlName="username"
        name="username"
        label="Nom d'utilisateur"
        [error]="getUsernameError()"
        [state]="getUsernameState()"
        helper="Vérification de disponibilité...">
      </ds-input-field>

      <ds-button
        variant="primary"
        submit
        [disabled]="!registerForm.valid || registerForm.pending">
        S'inscrire
      </ds-button>
    </form>
  `
})
export class RegisterComponent {
  private fb = inject(FormBuilder);
  private usernameValidator = inject(UsernameValidator);

  registerForm = this.fb.group({
    username: [
      '',
      [Validators.required, Validators.minLength(3)],
      [this.usernameValidator.validate.bind(this.usernameValidator)]
    ]
  });

  getUsernameError(): string {
    const field = this.registerForm.get('username');
    if (!field || !field.touched) return '';

    if (field.errors?.['required']) return 'Nom d'utilisateur requis';
    if (field.errors?.['minlength']) return 'Minimum 3 caractères';
    if (field.errors?.['usernameTaken']) return 'Ce nom est déjà pris';

    return '';
  }

  getUsernameState(): 'default' | 'success' | 'error' {
    const field = this.registerForm.get('username');
    if (!field || !field.touched) return 'default';
    if (field.pending) return 'default';
    if (field.valid) return 'success';
    return 'error';
  }

  onSubmit() {
    if (this.registerForm.valid) {
      console.log('Inscription:', this.registerForm.value);
    }
  }
}
```

---

## 4. Application complète avec routing et lazy-loading

Exemple d'une application Angular 20 standalone complète utilisant le design system avec routing, lazy-loading, et gestion de l'état via signals.

### Structure de l'application

```
src/app/
├── core/
│   ├── services/
│   │   ├── theme.service.ts       # Gestion du thème
│   │   └── auth.service.ts        # Authentification
│   └── guards/
│       └── auth.guard.ts          # Guard pour routes protégées
├── shared/
│   ├── components/
│   │   ├── header.component.ts   # Header avec navigation
│   │   └── footer.component.ts   # Footer
│   └── layouts/
│       └── main-layout.component.ts
├── features/
│   ├── home/
│   │   └── home.component.ts
│   ├── dashboard/
│   │   └── dashboard.component.ts (lazy-loaded)
│   └── settings/
│       └── settings.component.ts (lazy-loaded)
├── app.component.ts
├── app.config.ts
└── app.routes.ts
```

### Configuration de l'application (app.config.ts)

```typescript
import { ApplicationConfig, provideZoneChangeDetection } from '@angular/core';
import { provideRouter, withComponentInputBinding } from '@angular/router';
import { provideAnimations } from '@angular/platform-browser/animations';
import { routes } from './app.routes';

export const appConfig: ApplicationConfig = {
  providers: [
    provideZoneChangeDetection({ eventCoalescing: true }),
    provideRouter(routes, withComponentInputBinding()),
    provideAnimations(),
  ],
};
```

### Routes avec lazy-loading (app.routes.ts)

```typescript
import { Routes } from '@angular/router';
import { AuthGuard } from './core/guards/auth.guard';

export const routes: Routes = [
  {
    path: '',
    loadComponent: () =>
      import('./features/home/home.component').then(m => m.HomeComponent),
  },
  {
    path: 'dashboard',
    loadComponent: () =>
      import('./features/dashboard/dashboard.component').then(
        m => m.DashboardComponent
      ),
    canActivate: [AuthGuard],
  },
  {
    path: 'settings',
    loadComponent: () =>
      import('./features/settings/settings.component').then(
        m => m.SettingsComponent
      ),
    canActivate: [AuthGuard],
  },
  {
    path: 'login',
    loadComponent: () =>
      import('./features/auth/login.component').then(m => m.LoginComponent),
  },
  {
    path: '**',
    redirectTo: '',
  },
];
```

### Service de thème avec signals (theme.service.ts)

```typescript
import { Injectable, signal, effect } from '@angular/core';

export type Theme = 'light' | 'dark' | 'custom';

@Injectable({ providedIn: 'root' })
export class ThemeService {
  private readonly STORAGE_KEY = 'ds-theme';

  // Signal réactif pour le thème
  currentTheme = signal<Theme>(this.loadThemeFromStorage());

  constructor() {
    // Effect pour persister le thème et l'appliquer au DOM
    effect(() => {
      const theme = this.currentTheme();
      document.documentElement.className = `theme-${theme}`;
      localStorage.setItem(this.STORAGE_KEY, theme);
    });
  }

  setTheme(theme: Theme) {
    this.currentTheme.set(theme);
  }

  toggleTheme() {
    const current = this.currentTheme();
    const next = current === 'light' ? 'dark' : 'light';
    this.setTheme(next);
  }

  private loadThemeFromStorage(): Theme {
    const stored = localStorage.getItem(this.STORAGE_KEY);
    return (stored as Theme) || 'light';
  }
}
```

### Service d'authentification avec signals (auth.service.ts)

```typescript
import { Injectable, signal, computed } from '@angular/core';
import { Router } from '@angular/router';
import { Observable, of, delay } from 'rxjs';

interface User {
  id: number;
  username: string;
  email: string;
}

@Injectable({ providedIn: 'root' })
export class AuthService {
  private userSignal = signal<User | null>(null);

  // Exposer le user en lecture seule
  user = this.userSignal.asReadonly();

  // Computed pour savoir si l'utilisateur est connecté
  isAuthenticated = computed(() => this.user() !== null);

  constructor(private router: Router) {
    // Charger l'utilisateur depuis le localStorage au démarrage
    this.loadUserFromStorage();
  }

  login(username: string, password: string): Observable<boolean> {
    // Simulation d'appel API
    return of(true).pipe(
      delay(1000),
      map(() => {
        const mockUser: User = {
          id: 1,
          username,
          email: `${username}@example.com`,
        };
        this.userSignal.set(mockUser);
        localStorage.setItem('user', JSON.stringify(mockUser));
        return true;
      })
    );
  }

  logout() {
    this.userSignal.set(null);
    localStorage.removeItem('user');
    this.router.navigate(['/login']);
  }

  private loadUserFromStorage() {
    const stored = localStorage.getItem('user');
    if (stored) {
      try {
        this.userSignal.set(JSON.parse(stored));
      } catch {
        localStorage.removeItem('user');
      }
    }
  }
}
```

### Guard d'authentification (auth.guard.ts)

```typescript
import { inject } from '@angular/core';
import { Router, CanActivateFn } from '@angular/router';
import { AuthService } from '../services/auth.service';

export const AuthGuard: CanActivateFn = () => {
  const authService = inject(AuthService);
  const router = inject(Router);

  if (authService.isAuthenticated()) {
    return true;
  }

  // Rediriger vers la page de login
  router.navigate(['/login']);
  return false;
};
```

### Header avec navigation (header.component.ts)

```typescript
import { Component, inject } from '@angular/core';
import { Router, RouterLink, RouterLinkActive } from '@angular/router';
import { DsButton, DsBadge, DsDropdown, DropdownItem } from 'ds-angular';
import { AuthService } from '../../core/services/auth.service';
import { ThemeService } from '../../core/services/theme.service';

@Component({
  selector: 'app-header',
  standalone: true,
  imports: [RouterLink, RouterLinkActive, DsButton, DsBadge, DsDropdown],
  template: `
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <h1>DS App</h1>
          <ds-badge variant="info" size="sm">v1.0</ds-badge>
        </div>

        <nav class="nav">
          <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
            Accueil
          </a>
          @if (authService.isAuthenticated()) {
            <a routerLink="/dashboard" routerLinkActive="active">Dashboard</a>
            <a routerLink="/settings" routerLinkActive="active">Paramètres</a>
          }
        </nav>

        <div class="header-actions">
          <!-- Theme switcher -->
          <ds-dropdown
            [items]="themeOptions"
            [value]="themeService.currentTheme()"
            (selectionChange)="changeTheme($event)">
          </ds-dropdown>

          <!-- User menu ou login -->
          @if (authService.isAuthenticated()) {
            <ds-dropdown
              [items]="userMenuItems"
              (selectionChange)="onUserMenuAction($event)">
            </ds-dropdown>
          } @else {
            <ds-button
              variant="primary"
              size="sm"
              (clicked)="navigateToLogin()">
              Connexion
            </ds-button>
          }
        </div>
      </div>
    </header>
  `,
  styles: [`
    .header {
      background: var(--surface-default);
      border-bottom: 1px solid var(--border-default);
      padding: var(--space-4);
    }
    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: var(--space-6);
    }
    .logo {
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    .logo h1 {
      margin: 0;
      font-size: var(--font-size-5);
    }
    .nav {
      display: flex;
      gap: var(--space-4);
      margin-left: var(--space-6);
    }
    .nav a {
      color: var(--text-default);
      text-decoration: none;
      padding: var(--space-2) var(--space-3);
      border-radius: var(--radius-1);
      transition: background 0.2s;
    }
    .nav a:hover {
      background: var(--surface-hover);
    }
    .nav a.active {
      background: var(--surface-selected);
      font-weight: var(--font-weight-semibold);
    }
    .header-actions {
      margin-left: auto;
      display: flex;
      gap: var(--space-3);
      align-items: center;
    }
  `],
})
export class HeaderComponent {
  authService = inject(AuthService);
  themeService = inject(ThemeService);
  private router = inject(Router);

  themeOptions: DropdownItem[] = [
    { id: 'light', label: 'Clair', value: 'light' },
    { id: 'dark', label: 'Sombre', value: 'dark' },
    { id: 'custom', label: 'Personnalisé', value: 'custom' },
  ];

  userMenuItems: DropdownItem[] = [
    { id: 'profile', label: 'Profil' },
    { id: 'settings', label: 'Paramètres' },
    { id: 'logout', label: 'Déconnexion' },
  ];

  changeTheme(themeId: string) {
    this.themeService.setTheme(themeId as 'light' | 'dark' | 'custom');
  }

  onUserMenuAction(actionId: string) {
    if (actionId === 'logout') {
      this.authService.logout();
    } else if (actionId === 'settings') {
      this.router.navigate(['/settings']);
    }
  }

  navigateToLogin() {
    this.router.navigate(['/login']);
  }
}
```

### Layout principal (main-layout.component.ts)

```typescript
import { Component } from '@angular/core';
import { RouterOutlet } from '@angular/router';
import { HeaderComponent } from '../components/header.component';
import { FooterComponent } from '../components/footer.component';
import { DsToastContainerComponent } from 'ds-angular';

@Component({
  selector: 'app-main-layout',
  standalone: true,
  imports: [RouterOutlet, HeaderComponent, FooterComponent, DsToastContainerComponent],
  template: `
    <div class="layout">
      <app-header></app-header>
      <main class="content">
        <router-outlet></router-outlet>
      </main>
      <app-footer></app-footer>
      <ds-toast-container position="top-right"></ds-toast-container>
    </div>
  `,
  styles: [`
    .layout {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .content {
      flex: 1;
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
      padding: var(--space-6);
    }
  `],
})
export class MainLayoutComponent {}
```

### Composant racine (app.component.ts)

```typescript
import { Component } from '@angular/core';
import { MainLayoutComponent } from './shared/layouts/main-layout.component';

@Component({
  selector: 'app-root',
  standalone: true,
  imports: [MainLayoutComponent],
  template: `<app-main-layout></app-main-layout>`,
})
export class AppComponent {}
```

### Exemple de feature module lazy-loaded (dashboard.component.ts)

```typescript
import { Component, inject, signal, computed } from '@angular/core';
import { DsCard, DsBadge, DsButton, DsAlert } from 'ds-angular';
import { AuthService } from '../../core/services/auth.service';

interface Metric {
  label: string;
  value: number;
  trend: number;
  unit?: string;
}

@Component({
  selector: 'app-dashboard',
  standalone: true,
  imports: [DsCard, DsBadge, DsButton, DsAlert],
  template: `
    <div class="dashboard">
      <ds-alert type="success" [showIcon]="true" [closable]="true">
        Bienvenue {{ authService.user()?.username }} !
      </ds-alert>

      <h1>Dashboard</h1>

      <div class="metrics-grid">
        @for (metric of metrics(); track metric.label) {
          <ds-card variant="elevated" size="sm">
            <div header>
              <h3>{{ metric.label }}</h3>
            </div>
            <div body>
              <div class="metric-value">
                {{ metric.value }}{{ metric.unit || '' }}
                <ds-badge
                  [variant]="metric.trend >= 0 ? 'success' : 'error'"
                  size="sm">
                  {{ metric.trend >= 0 ? '+' : '' }}{{ metric.trend }}%
                </ds-badge>
              </div>
            </div>
          </ds-card>
        }
      </div>

      <ds-card variant="default" size="md">
        <div header>
          <h2>Activité récente</h2>
        </div>
        <div body>
          <p>Contenu du dashboard (graphiques, tableaux, etc.)</p>
          <ds-button variant="primary">Actualiser</ds-button>
        </div>
      </ds-card>
    </div>
  `,
  styles: [`
    .dashboard {
      display: flex;
      flex-direction: column;
      gap: var(--space-6);
    }
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--space-4);
    }
    .metric-value {
      font-size: var(--font-size-6);
      font-weight: var(--font-weight-bold);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
  `],
})
export class DashboardComponent {
  authService = inject(AuthService);

  metrics = signal<Metric[]>([
    { label: 'Utilisateurs', value: 1234, trend: 12 },
    { label: 'Ventes', value: 56.7, trend: -3, unit: 'k€' },
    { label: 'Commandes', value: 432, trend: 8 },
    { label: 'Taux conversion', value: 3.2, trend: 5, unit: '%' },
  ]);
}
```

Cette architecture complète démontre :
- ✅ **Routing** avec lazy-loading des features
- ✅ **Guards** pour protéger les routes
- ✅ **Signals** pour la gestion d'état réactive
- ✅ **Services** avec injection de dépendances
- ✅ **Layout** réutilisable avec header/footer
- ✅ **Intégration complète** du design system

---

## Ressources

- [Introduction](./Introduction) — Installation et Quick Start
- [Patterns](./Patterns) — Patterns de composition courants
- [Contributing](./Contributing) — Guide de contribution
