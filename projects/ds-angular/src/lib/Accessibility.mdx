import { Meta } from '@storybook/blocks';

<Meta title="Foundations/Accessibility" />

# Accessibilité — Guide WCAG 2.1 AA

Ce guide documente les patterns d'accessibilité implémentés dans le design system et fournit des recommandations pour garantir la conformité WCAG 2.1 niveau AA.

---

## 1. Principes fondamentaux

### 1.1 Les 4 principes POUR

<table style={{width: '100%', borderCollapse: 'collapse', marginBottom: '16px'}}>
  <thead>
    <tr style={{borderBottom: '2px solid var(--border-color, #e5e5e5)'}}>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '140px'}}>Principe</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600}}>Description</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '200px'}}>Exemple DS</th>
    </tr>
  </thead>
  <tbody>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px', fontWeight: 500}}>Perceptible</td>
      <td style={{padding: '12px 16px'}}>L'information doit être présentée de manière à être perçue</td>
      <td style={{padding: '12px 16px'}}>Contrastes 4.5:1, icônes avec labels</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px', fontWeight: 500}}>Opérable</td>
      <td style={{padding: '12px 16px'}}>L'interface doit être navigable au clavier</td>
      <td style={{padding: '12px 16px'}}>Focus trap, navigation flèches</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px', fontWeight: 500}}>Compréhensible</td>
      <td style={{padding: '12px 16px'}}>Le contenu doit être lisible et prévisible</td>
      <td style={{padding: '12px 16px'}}>Messages d'erreur clairs, comportements cohérents</td>
    </tr>
    <tr>
      <td style={{padding: '12px 16px', fontWeight: 500}}>Robuste</td>
      <td style={{padding: '12px 16px'}}>Le contenu doit être interprétable par les technologies d'assistance</td>
      <td style={{padding: '12px 16px'}}>ARIA roles, semantic HTML</td>
    </tr>
  </tbody>
</table>

### 1.2 Niveaux de conformité

```
Niveau A   → Exigences minimales (critique)
Niveau AA  → Standard recommandé (notre objectif)
Niveau AAA → Excellence (cible future)
```

---

## 2. Contraste et couleurs

### 2.1 Ratios de contraste minimum

<table style={{width: '100%', borderCollapse: 'collapse', marginBottom: '16px'}}>
  <thead>
    <tr style={{borderBottom: '2px solid var(--border-color, #e5e5e5)'}}>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600}}>Type de texte</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '120px'}}>Ratio minimum</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600}}>Tokens DS</th>
    </tr>
  </thead>
  <tbody>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Texte normal</td>
      <td style={{padding: '12px 16px'}}>4.5:1</td>
      <td style={{padding: '12px 16px'}}><code>--text-default</code> sur <code>--background-main</code></td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Grand texte (≥18px bold, ≥24px)</td>
      <td style={{padding: '12px 16px'}}>3:1</td>
      <td style={{padding: '12px 16px'}}><code>--text-muted</code> sur <code>--background-main</code></td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Éléments UI</td>
      <td style={{padding: '12px 16px'}}>3:1</td>
      <td style={{padding: '12px 16px'}}><code>--color-primary</code> sur <code>--background-main</code></td>
    </tr>
    <tr>
      <td style={{padding: '12px 16px'}}>Focus indicator</td>
      <td style={{padding: '12px 16px'}}>3:1</td>
      <td style={{padding: '12px 16px'}}><code>--color-primary</code> outline</td>
    </tr>
  </tbody>
</table>

### 2.2 Vérification dans le design system

```scss
// Contrastes validés dans _light.scss et _dark.scss
:root.theme-light {
  --text-default: #1f2937;      // Ratio 12.63:1 sur blanc
  --text-muted: #6b7280;        // Ratio 5.74:1 sur blanc
  --color-primary: #3b82f6;     // Ratio 3.1:1 sur blanc (UI)
}

:root.theme-dark {
  --text-default: #f9fafb;      // Ratio 15.8:1 sur #111827
  --text-muted: #9ca3af;        // Ratio 5.2:1 sur #111827
}
```

### 2.3 Ne pas utiliser uniquement la couleur

❌ **Incorrect** :
```html
<span style="color: red;">Erreur</span>
```

✅ **Correct** :
```html
<ds-alert type="error" showIcon>
  <fa-icon icon="exclamation-circle"></fa-icon>
  Erreur : ce champ est requis
</ds-alert>
```

---

## 3. Navigation clavier

### 3.1 Patterns de navigation implémentés

<table style={{width: '100%', borderCollapse: 'collapse', marginBottom: '16px'}}>
  <thead>
    <tr style={{borderBottom: '2px solid var(--border-color, #e5e5e5)'}}>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '140px'}}>Composant</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '120px'}}>Touches</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600}}>Comportement</th>
    </tr>
  </thead>
  <tbody>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={3}>Tabs</td>
      <td style={{padding: '12px 16px'}}><code>←→</code></td>
      <td style={{padding: '12px 16px'}}>Navigation entre onglets</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Home/End</code></td>
      <td style={{padding: '12px 16px'}}>Premier/dernier onglet</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Enter/Space</code></td>
      <td style={{padding: '12px 16px'}}>Activer l'onglet</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={4}>Dropdown</td>
      <td style={{padding: '12px 16px'}}><code>↓</code></td>
      <td style={{padding: '12px 16px'}}>Ouvrir menu, naviguer items</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>↑</code></td>
      <td style={{padding: '12px 16px'}}>Naviguer items vers le haut</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Enter</code></td>
      <td style={{padding: '12px 16px'}}>Sélectionner item</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Escape</code></td>
      <td style={{padding: '12px 16px'}}>Fermer menu</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={2}>Modal</td>
      <td style={{padding: '12px 16px'}}><code>Tab</code></td>
      <td style={{padding: '12px 16px'}}>Navigation cyclique (focus trap)</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Escape</code></td>
      <td style={{padding: '12px 16px'}}>Fermer modal</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={2}>Accordion</td>
      <td style={{padding: '12px 16px'}}><code>↑↓</code></td>
      <td style={{padding: '12px 16px'}}>Navigation entre headers</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Enter/Space</code></td>
      <td style={{padding: '12px 16px'}}>Toggle section</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={3}>DatePicker</td>
      <td style={{padding: '12px 16px'}}><code>←→↑↓</code></td>
      <td style={{padding: '12px 16px'}}>Navigation jours</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Enter</code></td>
      <td style={{padding: '12px 16px'}}>Sélectionner date</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Escape</code></td>
      <td style={{padding: '12px 16px'}}>Fermer calendrier</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={2}>Chip</td>
      <td style={{padding: '12px 16px'}}><code>Enter/Space</code></td>
      <td style={{padding: '12px 16px'}}>Activer chip (si clickable)</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Delete/Backspace</code></td>
      <td style={{padding: '12px 16px'}}>Supprimer chip (si removable)</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={3}>Slider</td>
      <td style={{padding: '12px 16px'}}><code>←→</code></td>
      <td style={{padding: '12px 16px'}}>Diminuer/augmenter valeur</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>Home/End</code></td>
      <td style={{padding: '12px 16px'}}>Valeur min/max</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}><code>PageUp/Down</code></td>
      <td style={{padding: '12px 16px'}}>Grands incréments</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)', background: 'var(--surface-subtle, #fafafa)'}}>
      <td style={{padding: '12px 16px', fontWeight: 600}} rowSpan={2}>FileUpload</td>
      <td style={{padding: '12px 16px'}}><code>Enter/Space</code></td>
      <td style={{padding: '12px 16px'}}>Ouvrir sélecteur fichiers</td>
    </tr>
    <tr>
      <td style={{padding: '12px 16px'}}><code>Tab</code></td>
      <td style={{padding: '12px 16px'}}>Navigation entre fichiers</td>
    </tr>
  </tbody>
</table>

### 3.2 Focus visible

Tous les éléments interactifs ont un indicateur de focus visible :

```scss
// Pattern standard dans tous les composants
&:focus-visible {
  outline: 2px solid var(--color-primary, #3b82f6);
  outline-offset: 2px;
}
```

### 3.3 Ordre de tabulation

L'ordre de tabulation suit l'ordre visuel du DOM :

```html
<!-- Ordre logique préservé -->
<ds-modal>
  <h2>Titre</h2>          <!-- 1 -->
  <p>Contenu</p>           <!-- non focusable -->
  <ds-input-field />       <!-- 2 -->
  <ds-button>Annuler</ds-button>   <!-- 3 -->
  <ds-button>Valider</ds-button>   <!-- 4 -->
</ds-modal>
```

### 3.4 Focus trap dans les modales

Le focus reste confiné dans la modale ouverte :

```typescript
// Implémentation dans DsModal
private trapFocus(): void {
  const focusableElements = this.getFocusableElements();
  const firstElement = focusableElements[0];
  const lastElement = focusableElements[focusableElements.length - 1];

  this.overlayRef.keydownEvents().subscribe((event) => {
    if (event.key === 'Tab') {
      if (event.shiftKey && document.activeElement === firstElement) {
        event.preventDefault();
        lastElement.focus();
      } else if (!event.shiftKey && document.activeElement === lastElement) {
        event.preventDefault();
        firstElement.focus();
      }
    }
  });
}
```

---

## 4. Attributs ARIA

### 4.1 Roles sémantiques

<table style={{width: '100%', borderCollapse: 'collapse', marginBottom: '16px'}}>
  <thead>
    <tr style={{borderBottom: '2px solid var(--border-color, #e5e5e5)'}}>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '120px'}}>Composant</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '180px'}}>Role</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600}}>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Modal</td>
      <td style={{padding: '12px 16px'}}><code>role="dialog"</code></td>
      <td style={{padding: '12px 16px'}}>+ <code>aria-modal="true"</code></td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Dropdown</td>
      <td style={{padding: '12px 16px'}}><code>role="listbox"</code></td>
      <td style={{padding: '12px 16px'}}>Items avec <code>role="option"</code></td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Tabs</td>
      <td style={{padding: '12px 16px'}}><code>role="tablist"</code></td>
      <td style={{padding: '12px 16px'}}>Tabs avec <code>role="tab"</code>, panels avec <code>role="tabpanel"</code></td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Alert</td>
      <td style={{padding: '12px 16px'}}><code>role="alert"</code></td>
      <td style={{padding: '12px 16px'}}>Annonce automatique aux lecteurs d'écran</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Toast</td>
      <td style={{padding: '12px 16px'}}><code>role="status"</code></td>
      <td style={{padding: '12px 16px'}}>Annonce polite aux lecteurs d'écran</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Progress</td>
      <td style={{padding: '12px 16px'}}><code>role="progressbar"</code></td>
      <td style={{padding: '12px 16px'}}>+ <code>aria-valuenow</code>, <code>aria-valuemin</code>, <code>aria-valuemax</code></td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Chip</td>
      <td style={{padding: '12px 16px'}}><code>role="button"</code></td>
      <td style={{padding: '12px 16px'}}>Si clickable + <code>aria-selected</code>, <code>aria-disabled</code></td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Slider</td>
      <td style={{padding: '12px 16px'}}><code>role="slider"</code></td>
      <td style={{padding: '12px 16px'}}>+ <code>aria-valuenow</code>, <code>aria-valuemin</code>, <code>aria-valuemax</code>, <code>aria-valuetext</code></td>
    </tr>
    <tr>
      <td style={{padding: '12px 16px'}}>FileUpload</td>
      <td style={{padding: '12px 16px'}}><code>role="button"</code></td>
      <td style={{padding: '12px 16px'}}>Dropzone focusable + <code>aria-label</code>, erreurs avec <code>role="alert"</code></td>
    </tr>
  </tbody>
</table>

### 4.2 États et propriétés

```html
<!-- Dropdown -->
<button
  [attr.aria-expanded]="isOpen"
  [attr.aria-haspopup]="'listbox'"
  [attr.aria-controls]="dropdownId">
  Sélectionner
</button>

<ul
  [id]="dropdownId"
  role="listbox"
  [attr.aria-activedescendant]="activeItemId">
  <li
    *ngFor="let item of items; let i = index"
    role="option"
    [id]="'item-' + i"
    [attr.aria-selected]="item === selectedItem">
    {{ item.label }}
  </li>
</ul>
```

### 4.3 Labels et descriptions

```html
<!-- Input avec label associé -->
<ds-input-field
  label="Email"
  hint="Nous ne partagerons jamais votre email"
  [error]="emailError">
</ds-input-field>

<!-- Génère -->
<label id="label-123" for="input-123">Email</label>
<input
  id="input-123"
  aria-labelledby="label-123"
  aria-describedby="hint-123 error-123" />
<span id="hint-123">Nous ne partagerons jamais votre email</span>
<span id="error-123" role="alert">{{ emailError }}</span>
```

---

## 5. Formulaires accessibles

### 5.1 Labels explicites

Chaque champ de formulaire doit avoir un label visible :

```html
✅ Correct
<ds-input-field label="Nom complet" />

❌ Incorrect
<ds-input-field placeholder="Nom complet" />
```

### 5.2 Messages d'erreur

Les erreurs doivent être :
- Annoncées aux lecteurs d'écran (`role="alert"`)
- Associées au champ (`aria-describedby`)
- Visuellement distinctes (couleur + icône)

```html
<ds-input-field
  label="Email"
  [error]="'Format d\'email invalide'"
  [showError]="emailControl.invalid && emailControl.touched">
</ds-input-field>
```

### 5.3 Groupes de champs

Utilisez `fieldset` et `legend` pour les groupes logiques :

```html
<fieldset>
  <legend>Adresse de livraison</legend>
  <ds-input-field label="Rue" />
  <ds-input-field label="Ville" />
  <ds-input-field label="Code postal" />
</fieldset>
```

### 5.4 Validation accessible

```typescript
// Exemple de validation avec feedback accessible
@Component({
  template: `
    <form (ngSubmit)="onSubmit()">
      <ds-input-field
        label="Email"
        type="email"
        [formControl]="emailControl"
        [error]="getEmailError()"
        [showError]="emailControl.invalid && emailControl.touched"
        hint="Entrez votre adresse email professionnelle">
      </ds-input-field>

      <ds-button
        type="submit"
        [disabled]="form.invalid"
        [attr.aria-disabled]="form.invalid">
        Envoyer
      </ds-button>
    </form>
  `
})
export class AccessibleFormComponent {
  emailControl = new FormControl('', [Validators.required, Validators.email]);

  getEmailError(): string {
    if (this.emailControl.hasError('required')) {
      return 'L\'email est requis';
    }
    if (this.emailControl.hasError('email')) {
      return 'Format d\'email invalide';
    }
    return '';
  }
}
```

---

## 6. Images et médias

### 6.1 Texte alternatif

```html
<!-- Image informative -->
<img src="chart.png" alt="Graphique montrant une croissance de 25% sur 6 mois" />

<!-- Image décorative -->
<img src="decoration.png" alt="" role="presentation" />

<!-- Icône avec signification -->
<fa-icon [icon]="faCheck" aria-label="Succès"></fa-icon>

<!-- Icône décorative -->
<fa-icon [icon]="faChevronRight" aria-hidden="true"></fa-icon>
```

### 6.2 Boutons avec icônes seules

```html
<!-- Toujours fournir un label accessible -->
<ds-button
  variant="ghost"
  aria-label="Fermer la modale">
  <fa-icon [icon]="faXmark" aria-hidden="true"></fa-icon>
</ds-button>
```

---

## 7. Composants dynamiques

### 7.1 Régions live

```html
<!-- Annonce automatique des mises à jour -->
<div role="status" aria-live="polite" aria-atomic="true">
  {{ statusMessage }}
</div>

<!-- Annonce urgente (erreurs critiques) -->
<div role="alert" aria-live="assertive">
  {{ criticalError }}
</div>
```

### 7.2 Toast et notifications

```typescript
// DsToastService annonce automatiquement
this.toastService.show({
  type: 'success',
  message: 'Document enregistré',
  // Automatiquement annoncé via aria-live="polite"
});
```

### 7.3 Loading states

```html
<!-- Indicateur de chargement accessible -->
<ds-skeleton
  *ngIf="loading"
  aria-label="Chargement en cours"
  aria-busy="true">
</ds-skeleton>

<ds-progress-bar
  [value]="uploadProgress"
  [ariaLabel]="'Upload en cours: ' + uploadProgress + '%'">
</ds-progress-bar>
```

---

## 8. Skip links

Permettre de sauter directement au contenu principal :

```html
<!-- En début de page -->
<a href="#main-content" class="skip-link">
  Aller au contenu principal
</a>

<!-- Contenu principal -->
<main id="main-content" tabindex="-1">
  ...
</main>
```

```scss
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  padding: 8px 16px;
  background: var(--color-primary);
  color: white;
  z-index: 9999;

  &:focus {
    top: 0;
  }
}
```

---

## 9. Tests d'accessibilité

### 9.1 Outils automatisés

```bash
# Audit Axe dans Storybook
npm run test:a11y

# Audit WAVE via CI
npm run audit:wave

# Tests Playwright avec assertions a11y
npm run test:e2e
```

### 9.2 Checklist manuelle

<table style={{width: '100%', borderCollapse: 'collapse', marginBottom: '16px'}}>
  <thead>
    <tr style={{borderBottom: '2px solid var(--border-color, #e5e5e5)'}}>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600, width: '160px'}}>Critère</th>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600}}>Test</th>
      <th style={{textAlign: 'center', padding: '12px 16px', fontWeight: 600, width: '80px'}}>Statut</th>
    </tr>
  </thead>
  <tbody>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Navigation clavier</td>
      <td style={{padding: '12px 16px'}}>Tab à travers tous les éléments interactifs</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Focus visible</td>
      <td style={{padding: '12px 16px'}}>Indicateur visible sur tous les éléments focusés</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Skip link</td>
      <td style={{padding: '12px 16px'}}>Lien "Aller au contenu" fonctionnel</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Zoom 200%</td>
      <td style={{padding: '12px 16px'}}>Pas de perte de contenu à 200% zoom</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Contraste</td>
      <td style={{padding: '12px 16px'}}>Ratio ≥4.5:1 pour texte normal</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>Screen reader</td>
      <td style={{padding: '12px 16px'}}>Annonces cohérentes (VoiceOver, NVDA)</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr>
      <td style={{padding: '12px 16px'}}>Motion reduced</td>
      <td style={{padding: '12px 16px'}}><code>prefers-reduced-motion</code> respecté</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
  </tbody>
</table>

### 9.3 Tests avec lecteurs d'écran

```typescript
// Pattern de test avec assertions ARIA
it('should announce modal title to screen readers', () => {
  const modal = fixture.debugElement.query(By.css('.ds-modal'));

  expect(modal.nativeElement.getAttribute('role')).toBe('dialog');
  expect(modal.nativeElement.getAttribute('aria-modal')).toBe('true');
  expect(modal.nativeElement.getAttribute('aria-labelledby')).toBeTruthy();
});
```

---

## 10. Préférences utilisateur

### 10.1 Reduced motion

```scss
@media (prefers-reduced-motion: reduce) {
  .ds-modal,
  .ds-toast,
  .ds-skeleton {
    animation: none;
    transition: none;
  }
}
```

### 10.2 High contrast

```scss
@media (prefers-contrast: more) {
  :root {
    --border-default: #000;
    --color-primary: #0056b3;
  }
}
```

### 10.3 Dark mode

```typescript
// Détection automatique dans ThemeService
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');

if (prefersDark.matches) {
  document.documentElement.classList.add('theme-dark');
}

prefersDark.addEventListener('change', (e) => {
  document.documentElement.classList.toggle('theme-dark', e.matches);
});
```

---

## 11. Ressources

### 11.1 Standards

- [WCAG 2.1](https://www.w3.org/WAI/WCAG21/quickref/) — Quick Reference
- [WAI-ARIA 1.2](https://www.w3.org/TR/wai-aria-1.2/) — Spécification
- [ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/) — Patterns UI

### 11.2 Outils

- [Axe DevTools](https://www.deque.com/axe/) — Extension navigateur
- [WAVE](https://wave.webaim.org/) — Évaluateur en ligne
- [Contrast Checker](https://webaim.org/resources/contrastchecker/) — Vérificateur contraste
- [Screen Reader Testing](https://www.nvaccess.org/download/) — NVDA (gratuit)

### 11.3 Design System conformité

<table style={{width: '100%', borderCollapse: 'collapse', marginBottom: '16px'}}>
  <thead>
    <tr style={{borderBottom: '2px solid var(--border-color, #e5e5e5)'}}>
      <th style={{textAlign: 'left', padding: '12px 16px', fontWeight: 600}}>Composant</th>
      <th style={{textAlign: 'center', padding: '12px 16px', fontWeight: 600}}>Keyboard</th>
      <th style={{textAlign: 'center', padding: '12px 16px', fontWeight: 600}}>ARIA</th>
      <th style={{textAlign: 'center', padding: '12px 16px', fontWeight: 600}}>Focus</th>
      <th style={{textAlign: 'center', padding: '12px 16px', fontWeight: 600}}>Contrast</th>
    </tr>
  </thead>
  <tbody>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsButton</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsModal</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsDropdown</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsTabs</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsAccordion</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsToast</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsTooltip</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsDatePicker</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsTable</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsSelect</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsCombobox</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsChip</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr style={{borderBottom: '1px solid var(--border-color, #e5e5e5)'}}>
      <td style={{padding: '12px 16px'}}>DsSlider</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
    <tr>
      <td style={{padding: '12px 16px'}}>DsFileUpload</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
      <td style={{padding: '12px 16px', textAlign: 'center'}}>✅</td>
    </tr>
  </tbody>
</table>
